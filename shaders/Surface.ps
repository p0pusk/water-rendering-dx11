#include "shaders/Light.h"

struct VSOutput
{
    float4 pos : SV_Position;
    float3 worldPos : POSITION;
    float4 color : COLOR;
    float3 norm : NORMAL;
    float3 tang : TANGENT;
    float2 uv : TEXCOORD;
};

cbuffer GeomBuffer : register (b1)
{
    float4x4 model;
    float4x4 norm;
    float4 shine;
    float4 color;
};

float4 ps(VSOutput pixel) : SV_Target0
{
  float4 finalColor = float4(0, 0, 0, 0);
#ifdef VERTEX_COLOR
  finalColor = pixel.color;
#else
  finalColor = color;
#endif

#ifdef NO_LIGHTS
    return finalColor;
#else
    return float4(CalculateColor(finalColor.xyz, normalize(pixel.norm),
                                 pixel.worldPos.xyz, shine.x, false), finalColor.w);
#endif
}
